This source code is the production version 
here is the new feature nested loop 
